<html>

<head>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
    crossorigin="anonymous">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!-- 
To collect user behavior analytics about your application, 
insert the following script into each page you want to track.
Place this code immediately before the closing </head> tag,
and before any other scripts. Your first data will appear 
automatically in just a few seconds.
-->
  <script type="text/javascript">
    var appInsights = window.appInsights || function (a) {
      function b(a) {
        c[a] = function () {
          var b = arguments;
          c.queue.push(function () {
            c[a].apply(c, b)
          })
        }
      }
      var c = {
          config: a
        },
        d = document,
        e = window;
      setTimeout(function () {
        var b = d.createElement("script");
        b.src = a.url || "https://az416426.vo.msecnd.net/scripts/a/ai.0.js", d.getElementsByTagName("script")[0].parentNode
          .appendChild(b)
      });
      try {
        c.cookie = d.cookie
      } catch (a) {}
      c.queue = [];
      for (var f = ["Event", "Exception", "Metric", "PageView", "Trace", "Dependency"]; f.length;) b("track" + f.pop());
      if (b("setAuthenticatedUserContext"), b("clearAuthenticatedUserContext"), b("startTrackEvent"), b(
          "stopTrackEvent"), b("startTrackPage"), b("stopTrackPage"), b("flush"), !a.disableExceptionTracking) {
        f = "onerror", b("_" + f);
        var g = e[f];
        e[f] = function (a, b, d, e, h) {
          var i = g && g(a, b, d, e, h);
          return !0 !== i && c["_" + f](a, b, d, e, h), i
        }
      }
      return c
    }({
      instrumentationKey: "<%= aikey %>"
    });

    window.appInsights = appInsights, appInsights.queue && 0 === appInsights.queue.length && appInsights.trackPageView();

  </script>
</head>

<body>
  <div class="container">
    <h4>
      <%= message %>
    </h4>
  </div>
  <div class="container">
    <table class="table table-bordered table-striped">
      <thead class="thead-dark">
        <tr>
          <th scope="col">Name</th>
          <th scope="col">Gender</th>
        </tr>
      </thead>
      <% for(var i=0; i < apiData.length; i++) { %>
      <tr>
        <td>
          <%= apiData[i].userName %>
        </td>
        <td>
          <%= apiData[i].gender %>
        </td>
      </tr>
      <% } %>
    </table>
    <h3 id="result"></h3>
  </div>
</body>
<script>
$( document ).ready(function() {
    $.get( "http://<%= apiUrl %>/api/version", function( data ) {
    $("#result").text("Calling API from " + data[0] + " v: " + data[1]);
    console.log(data);
});
});
</script>
</html>
